{% extends 'nav.html' %}
{% load staticfiles %}
{% block css %}
    <link rel="stylesheet" href="/static/layui/css/layui.css">
{% endblock %}

{% block content %}
    <div class="layui-main">
        <table id="imagelist" lay-filter="image"></table>
    </div>
{% endblock %}
{% block script %}
    <script type="text/html" id="barDemo">
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
    </script>


    <script>
        layui.use(['table', 'jquery', 'layer', 'form'], function () {

            var table = layui.table,
                layer = layui.layer,
                form = layui.form,
                $ = layui.jquery

            //方法级渲染
            table.render({
                elem: '#imagelist', //指定原始表格元素选择器（推荐id选择器）
                url: '{% url 'hosts:get_imagelist' %}',
                method: 'get',
                page: true, //分页
                limit: 10,
                skin: 'line', //行边框风格
                even: true, //开启隔行背景
                height: 'full-160', //高度
                cols: [[
                    {checkbox: true, fixed: true},
                    {field: '镜像', title: 'image', width: '85%'},
                    {title: '操作', align: 'center', toolbar: '#barDemo', width: '15%'},
                ]],

            });

            //监听工具条
            table.on('tool(image)', function (obj) { //注：tool是工具条事件名，host是table原始容器的属性 lay-filter="对应的值"
                var data = obj.data; //获得当前行数据
                var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
                var tr = obj.tr; //获得当前行 tr 的DOM对象

                if (layEvent === 'del') { //删除
                    layer.confirm('真的删除行么', function (index) {
                        obj.del(); //删除对应行（tr）的DOM结构，并更新缓存
                        layer.close(index);
                        //向服务端发送删除指令
                    });
                }
            });
        });
    </script>
{% endblock %}